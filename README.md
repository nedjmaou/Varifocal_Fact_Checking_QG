# Varifocal Question Generation for Fact-Checking

Code and data of our EMNLP 2022 paper "Varifocal Question Generation for Fact-checking" (Nedjma Ousidhoum, Zhangdie Yuan, Andreas Vlachos https://arxiv.org/pdf/2210.12400.pdf)

<pre>
.
+-- data
|   +-- generator
|       +-- train.json
|       +-- ...
|   +-- reranker
|       +-- focal_train_question.json
|       +-- ...
|   +-- reranker
|       +-- train.json
|       +-- ...
+-- src
|   +-- train.py
|   +-- ...
+-- scripts
|   +-- train.py
|   +-- ...
+-- README.md
...
</pre>

## Packages
Required packages are detailed in `requirements.txt`, which is automatically generated by conda.

Important packages:
- Python 3.8
- PyTorch >= 1.8.1
- Transformers >= 4.6.0
- whoosh == 2.7.4
- scikit-learn
- NLTK
- spaCy 


## Use
### Train a generator
`./scripts/train.sh`

Parameters can be found in the script such as batch size, epochs, save_strategy etc. Data can be found in the `data` folder.
### Train a reranker
`(env) python src/reranker_train.py $MODEL_NAME$`

Similarly, the name of the reranker model is required as input (i.e., `squad`, `focal`, or `focal_meta`) which corresponds to different data splits in the `data` folder..
### Test a varifocal model (both generator and reranker)
`(env) python src/predict.py test $PATH_TO_GENERATOR_MODEL$ $PATH_TO_RERANKER_MODEL$ $NUM_OF_TAGS$ $NE_ONLY$`

where `$PATH_TO_GENERATOR_MODEL$` and `$PATH_TO_RERANKER_MODEL$` refer to the paths to each model, `$NUM_OF_TAGS$` refers to filtering generated questions based on dependency tags of focal points, shown below:

`set_of_tags = {'1': ['csubj', 'xcomp', 'ccomp', 'advcl', 'acl'],
               '2': ['nsubj', 'obj', 'iobj'],
               '3': ['csubj', 'xcomp', 'ccomp', 'advcl', 'acl', 'nsubj', 'obj', 'iobj'],
               '4': ['nmod', 'amod', 'obj', 'num'],
               '5': ['nsubj', 'obj', 'iobj', 'nmod', 'amod', 'obj', 'num'],
               '6': ['csubj', 'xcomp', 'ccomp', 'advcl', 'acl', 'nsubj', 'obj', 'iobj', 'nmod', 'amod', 'obj', 'num'],}`

set `$NUM_OF_TAGS$` to 0 to include all tags (no filtering). `$NE_ONLY$` refers to filtering generated questions based on whether the focal point is a named entity (`yes`, `no`, or `all`). 

## Models
Our question generation model is available on HuggingFace (see https://huggingface.co/nedjmaou/varifocal_qg_fact-checking/)
